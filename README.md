##外联平台



### 前端项目开发流程

> * 建立项目群组并关联`submodule`
>
> > 1. 建立项目群组，并在群组中建立`根项目仓库`、`cli项目仓库`、`各模块项目仓库`（各仓库名需按统一规范命名，且名称以下操作会用到）。
> > 2. 在根项目中用`submodule`添加关联各子模块（含`cli`）项目地址，并提交到根项目中。（`git submodule add [各模块项目地址]` ）。
>
> * 通过获取demo项目新建自己的项目
>
> >1. 用`脚本文件cli-new.sh`获取demo项目（`[脚本文件地址] install [cli项目名] [cli项目地址]`）。
> >2. 在`src/pages`下`clone`自己负责的项目模块，在相应的位置进行开发和提交。
> >
> >**要注意的是：** 提交代码时，先提交自己负责的模块代码到相应地址，再提交`cli模块`代码。
>
> * 项目已存在时，如何加入到项目开发中?
>
> > 1. 用`脚本文件cli-join.sh`直接获取`cli项目`（`[脚本文件地址] install [cli项目名] [cli项目地址]`）。
> > 2. 在`src/pages`下`clone`自己负责的项目模块，在相应的位置进行开发和提交。
>
> * 维护全局Component和layouts
>
> > 1. `clone`全局模块项目，修改维护好后提交。
> > 2. 测试UI确认通过后将`/src/components/Global/*`单独抽离提交到`Global项目仓库`中，将`/src/layouts/*`单独抽离提交到`layouts项目仓库`中。
> > 3. 维护开发时注意`Global` 和`layouts`与其他代码不要有耦合性。
>



###前端项目开发规范

>  * 用`const`和`let`，而避免使用`var`。
>
>  * 代码行末尾不要有`;`号。
>
>  * 对象中每项末尾始终保持有`,`号，即里面有多少个属性就保持有多少个`,`号，单行情况可以不用。
>
>  * 用less写你的样式，并利用classnames库动态添加样式。
>
>  * 所有和页面组件相关的js文件，清除你不需要的引入和声明而未使用的变量、常量。
>
>  * 把你的编辑器tab值设置为两个空格。
>
>  * 在文件开头导入`import`，在文件末尾`export`。
>
>  * 前端模拟的菜单接口在mock中修改，如需新增模拟接口要在`.umirc.mock.js`文件中引入。
>
>  * 修改或新增项目公共或默认样式，需与其他前端人员协商后在`theme`目录下更改。
>
>  * 同理，新增项目公共工具方法，需与其他前端人员协商后在`utils`目录下更改。
>
>  * 接口对接请求，使用`utils/request`中的封装的方法，目前已包括封装**加密处理**，加密开关在`setting/config中`配置。
>
>  * `model`中的空间名以`_`连接。
>
>    > 注：侧边次级菜单的一级目录为一个**模块**。**模块名**中的中横线`-`改为下横线`_` 。
>    >
>    > * 某个模块下的页面model，命名为`当前页面所属模块名 + 当前页面名`。
>    > * 模块只有一个页面，命名为`当前模块名`即可。
>    > * 内页（侧边菜单中不显示的页面）model，命名为`所属模块名 + 所属页面名 + 当前内页页面名`。
>
>  * `model`中的状态数据，每条`state`需要简单注释说明它的用途（如：`list: [],  //表格数据`）。
>
>  * 同理，页面和组件中的`props`，在做`类型校验(必做)`的地方简单注释它的用途。
>
>  * `pages`新建文件除`umi规则`外，还包括以下约束：
>
>    > * 文件夹名与路由地址保持一致。（包括嵌套路由、动态路由）
>    > * 所有主体页面命名为`index.js`，当前页面只有单个`model`和`service`管理时，只用建立`model.js`和`service.js`，有多个时分别放在同级目录的`models文件夹`和`services文件夹`下。（每个模块的总览概况页可以不用`index.js`为页面，可直接建名称相应的js文件为其页面）。
>    > * 当前页面的组件放在`components文件夹`下，组件的文件命名以**大写字母**开头，代码中组件名则需加入`YQ`前缀，用以在代码中区分`antd`提供的组件。
>    > * 样式文件与页面和组件文件名一致，且放在相应同级目录中即可。
>    > * `pages`目录下每个模块根目录内预留有`constant.js`存放常量文件，目前用于存放`模块名（前缀）`、`模块路由（前缀）`、`请求相关配置`和`内页路由`等，可按需求添加相关配置常量。
>
>  * 关于`setting文件夹`，`config.js`用于存放项目整体信息，`constant.js`用于存放项目公共常量。要注意的是：**每个模块的内页路由信息需要引入到`constant.js`文件中**（详细可参照demo项目）。
>
>  * 只需要提交自己负责的模块代码，提交前用工具进行`差异比较`,勾选好自己负责的模块代码再提交。
>
>  * 更改除自己配置文件以外的`cli模块`代码需要和其他前端人员协商，确认后统一协商提交。



###目录结构说明

> - `目录结构`中**root** 标记为项目初始化配置和公共模块，开发人员不可随意修改，部分内容后期会不断优化新增。
> - 由于路由是根据pages下目录结构生成，故pages下的业务文件夹新建需和后台协商，文件夹命名要与菜单接口返回的路由地址一致。路由生成规则参照[umi官网路由指南](https://umijs.org/guide/router.html)。

```
├─dist                         打包后输出目录
│            
├─mock                         前端模拟接口数据
│               
├─public                       静态资源（字体图标）
│  └─public                    ------（打包后copy至dist）
│      │  logo.svg             ------logo
│      ├─antd                  ------存放antd本地字体图标（root）
│      └─orgine                ------存放项目本地字体图标（所有图标文件默认以`iconfont.*`命名）
│   
└─src   
│  │  global.js                全局引入（root）
│  │     
│  ├─components	               公共组件
│  │  │  index.js              ------公共组件全局导出（root）
│  │  ├─Global	               ------全局公用组件（root）
│  │  │   index.js             ------全局公共组件导入导出口（维护时导出变量以YQ为前缀） 
│  │  │  ├─Iconfont            ------全局公共组件示例：（每个组件一个文件夹，首字母大写）
│  │  │  │    Iconfont.js      ------组件js （首字母大写）
│  │  │  │    Iconfont.less    ------组件依赖样式（首字母大写）
│  │  │  │    package.json     ------组件配置参数 （必写）
│  │  │  ├─
│  │  ├─Privte	               ------项目私有公共组件
│  │  │  index.js              ------项目私有公共组件导入导出口（维护时导出变量以YQ为前缀） 
│  │              
│  ├─layouts                   项目结构文件目录（root）
│  │  │  app.js                ------结构组件组合	
│  │  │  app.less	           ------依赖样式	
│  │  │  index.js              ------项目入口
│  │  │  
│  │  ├─components	           ------项目结构公共组件目录
│  │  ├─models                 ------项目结构的model目录
│  │  └─services               ------项目结构的请求目录    
│  │
│  ├─pages   /**页面（路由、业务）目录**/
│  │  │    
│  │  ├─{pagename}             某页面目录（以下为一个模块示例）
│  │  │  │  constant.js	       ------当前模块常量
│  │  │  │  index.js	       ------当前页面入口
│  │  │  ├─models	           ------当前页model文件夹
│  │  │  ├─services	           ------当前页请求文件夹
│  │  │  └─components          ------当前页组件目录
│  │  │       ModalForm.js	   ------组件文件（大写开头，代码中组件命名以YQ开头，以区分antd组件）
│  │  │       SearchForm.js
│  │  │       Table.js
│  │  │       Tree.js        
│  │  │
│  │  ├─login  	                登录页目录（root）
│  │  │  │  index.js
│  │  │  │  index.less
│  │  │  │  model.js
│  │  │  │  service.js     
│  │  │
│  │  ├─error  	                公共错误页面目录（root）
│  │  │  └─404  	            ------404页目录
│  │  │     │  index.js
│  │  │     │  index.less
│  │  │
│  │  document.ejs              app模板（root）
│  │  index.js                  app路由重定向包裹（root）      
│  │
│  ├─plugins
│  │  │   onError.js            全局系统错误处理（root）
│  │      
│  ├─setting	                项目配置目录
│  │  │   config.js		        ------项目配置（常用配置等）
│  │  │   constant.js	        ------项目公共常量（请求报文、内页路由等）
│  │  │   index.js	            ------项目配置文件导入导出口
│  │     
│  ├─themes		                公共及默认样式（root） 
│  │  │   default.less	         ------更改antd样式变量
│  │  │   index.less	         ------更改antd默认样式
│  │  │   private.less	         ------项目公共样式变量及函数（less版）
│  │  │   global.less            ------全局公共样式变量及函数（less版）
│  │     
│  └─utils			            封装工具函数（root） 
│  │  │   model.js		         ------用于model扩展（公共model）	
│  │  │   request.js	         ------请求函数封装
│  │  │   theme.js		         ------公共样式变量（js版）
│  │  │   index.js		         ------封装函数导入导出口
│  
├─.webpackrc.js             webpack配置文件（可在本地配置请求代理，文件不上传！！）
├─.umirc.mock.js            新增模拟的mock数据接口需在该文件中新增引入（避免冲突，文件不上传！！）
├─{ * }.{ * }               其他配置文件（root）

```

